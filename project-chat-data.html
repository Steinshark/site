<div class="container">
  <div class="original-prompt" id="original-prompt">Loading prompt...</div>
  <div class="options">
    <div class="option" id="option-a">Option A</div>
    <div class="option" id="option-b">Option B</div>
  </div>
</div>

<style>
.original-prompt {
  font-size: 1.1rem;
  margin-bottom: 2rem;
  background-color: var(--panel-dark);
  padding: 1rem;
  border-radius: 8px;
  border-left: 4px solid #00c3ff;
}

.option {
  background-color: var(--panel-dark);
  padding: 1rem;
  margin-bottom: 1rem;
  border-radius: 8px;
  cursor: pointer;
  transition: transform 0.1s ease, background 0.2s ease;
}

.option:hover {
  background-color: #444;
  transform: scale(1.02);
}

.option.selected {
  border: 2px solid #00c3ff;
}
</style>

<script>
const optionA = document.getElementById('option-a');
const optionB = document.getElementById('option-b');
const originalPrompt = document.getElementById('original-prompt');

async function loadPrompt() {
  try {
    const response = await fetch("https://api.hipowerpc.com/api/rlhf-next", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ request_type: "next_prompt" })
    });

    const data = await response.json();

    originalPrompt.textContent = data.prompt; // original prompt text
    optionA.textContent = "A: " + data.option_a;
    optionB.textContent = "B: " + data.option_b;

    // Reset any previous selection
    optionA.classList.remove("selected");
    optionB.classList.remove("selected");
  } catch (err) {
    console.error("Failed to fetch prompt:", err);
    originalPrompt.textContent = "Failed to load prompt.";
  }
}

// Optional: click handler
optionA.addEventListener('click', () => {
  optionA.classList.add('selected');
  optionB.classList.remove('selected');
  submitSelection('A');
});

optionB.addEventListener('click', () => {
  optionB.classList.add('selected');
  optionA.classList.remove('selected');
  submitSelection('B');
});

async function submitSelection(choice) {
  try {
    await fetch("https://api.hipowerpc.com/api/rlhf-submit", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ choice })
    });
    loadPrompt(); // load next prompt automatically
  } catch (err) {
    console.error("Failed to submit choice:", err);
  }
}

// Initial load
loadPrompt();
</script>
